machine:
  timezone: Asia/Tokyo
  pre:
    - curl https://raw.githubusercontent.com/creationix/nvm/v0.23.3/install.sh | bash
  node:
    version: 0.12
deployment:
  master:
    branch: src
    commands:
      - npm run build
      - git config --global user.email ishikura.noboru@gmail.com
      - git config --global user.name "CircleCI"
      - mkdir $CIRCLE_ARTIFACTS/public
      - cp public/* $CIRCLE_ARTIFACTS/public/
      - rm -rf *
      - cp $CIRCLE_ARTIFACTS/public/* .
      - git add --force .
      - git commit -m "Release $CIRCLE_BUILD_NUM"
      - git push origin $CIRCLE_BRANCH:master
